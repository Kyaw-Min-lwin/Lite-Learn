{% extends 'core/base.html' %}

{% block content %}

<!-- Header Navigation -->
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
    <a href="/upload/"
        style="color: var(--text-muted); text-decoration: none; font-weight: 600; display: flex; align-items: center; gap: 5px;">
        â† <span style="border-bottom: 2px solid transparent;">Upload Another</span>
    </a>

    <a href="{% url 'download_pdf' lecture.pk %}" class="btn"
        style="width: auto; padding: 8px 16px; font-size: 0.9em; background: var(--text-main);">
        â¬‡ Download PDF
    </a>
    </div>

<!-- Title Section -->
<div style="margin-bottom: 32px;">
    <div style="display: flex; gap: 10px; align-items: center; margin-bottom: 8px;">
        <span
            style="background: var(--primary-light); color: var(--primary-dark); font-size: 0.75rem; font-weight: 700; padding: 4px 8px; border-radius: 6px; text-transform: uppercase; letter-spacing: 0.5px;">
            Success
        </span>
        <span style="color: var(--text-muted); font-size: 0.9em;">{{ lecture.created_at|date:"M d, Y" }}</span>
    </div>
    <h1 style="margin-bottom: 0;">{{ lecture.title }}</h1>
</div>

<!-- The "Money Shot" Impact Card - Modern Grid Layout -->
<div
    style="background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); border-radius: 16px; padding: 32px; color: white; margin-bottom: 32px; box-shadow: var(--shadow-lg);">
    <div style="display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 24px;">
        <h3 style="color: white; margin: 0; opacity: 0.9; font-size: 1.1em;">ğŸ“‰ Bandwidth Savings Report</h3>
        <div
            style="background: rgba(255,255,255,0.2); backdrop-filter: blur(5px); padding: 4px 12px; border-radius: 20px; font-size: 0.85em; font-weight: 600;">
            LiteLearn Optimized
        </div>
    </div>

    <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 20px; align-items: center; text-align: center;">
        <!-- Original -->
        <div style="text-align: left;">
            <div style="font-size: 2em; font-weight: 800;">{{ lecture.original_size_mb }}<span
                    style="font-size: 0.5em; opacity: 0.7;">MB</span></div>
            <div style="font-size: 0.9em; opacity: 0.8;">Original Video</div>
        </div>

        <!-- Arrow Visual -->
        <div style="opacity: 0.5; font-size: 2em;">â†’</div>

        <!-- New Size -->
        <div style="text-align: right;">
            <div style="font-size: 2em; font-weight: 800; color: #fff;">{{ lecture.new_size_mb }}<span
                    style="font-size: 0.5em; opacity: 0.7;">MB</span></div>
            <div style="font-size: 0.9em; opacity: 0.8;">Audio & Text</div>
        </div>
    </div>

    <div
        style="margin-top: 24px; background: rgba(0,0,0,0.2); border-radius: 10px; padding: 12px; display: flex; align-items: center; gap: 10px;">
        <span style="font-size: 1.2em;">ğŸ‰</span>
        <span style="font-size: 0.95em;">You saved <strong>{{ lecture.data_saved_percentage }}%</strong> of your mobile
            data on this lecture.</span>
    </div>
    </div>

<div class="card">
    <h2 style="display: flex; align-items: center; gap: 10px;">
        <span>ğŸ§</span> Low-Bandwidth Audio
    </h2>
    <div style="background: #f1f5f9; padding: 16px; border-radius: 12px; border: 1px solid var(--border);">
        {% if lecture.processed_audio %}
        <audio controls style="width: 100%; height: 40px;">
            <source src="{{ lecture.processed_audio.url }}" type="audio/mpeg">
            Your browser does not support the audio element.
        </audio>
        <div style="margin-top: 8px; font-size: 0.85em; color: var(--text-muted); text-align: right;">
            Format: MP3 Mono â€¢ 32kbps
        </div>
        {% else %}
        <p class="text-muted">Audio processing failed.</p>
        {% endif %}
        </div>
</div>

<div class="card" style="border-left: 5px solid var(--accent);">
    <h2 style="display: flex; align-items: center; gap: 10px;">
        <span>âš¡</span> AI Study Guide
    </h2>
    <div class="ai-content">
        <!-- The SAFE filter is crucial here for your markdown -->
        {{ lecture.summary | safe }}
    </div>
</div>

<div class="card">
    <h2 style="display: flex; align-items: center; gap: 10px;">
        <span>ğŸ“„</span> Full Transcript
    </h2>
    <div class="custom-scroll"
        style="background: #f8fafc; padding: 20px; border-radius: 12px; border: 1px solid var(--border); height: 300px; overflow-y: auto; font-family: 'Courier New', monospace; font-size: 0.9em; color: var(--text-muted); line-height: 1.8;">
        {{ lecture.transcript }}
    </div>
</div>

{% endblock %}